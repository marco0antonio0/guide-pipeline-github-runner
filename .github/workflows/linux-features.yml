# Pipeline Linux - Recursos EspecÃ­ficos do Runner Linux
# Este workflow demonstra recursos e capacidades do runner Linux

name: Recursos do Linux Runner

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  # InformaÃ§Ãµes do Sistema Linux
  system-info:
    runs-on: ubuntu-latest
    steps:
      - name: InformaÃ§Ãµes detalhadas do sistema
        run: |
          echo "ğŸ§ === INFORMAÃ‡Ã•ES DO SISTEMA LINUX ==="
          echo ""
          echo "ğŸ“Œ DistribuiÃ§Ã£o:"
          cat /etc/os-release
          echo ""
          echo "ğŸ”§ Kernel:"
          uname -r
          echo ""
          echo "ğŸ’¾ MemÃ³ria:"
          free -h
          echo ""
          echo "ğŸ’¿ Disco:"
          df -h
          echo ""
          echo "âš™ï¸ CPU:"
          lscpu | grep -E "Model name|CPU\(s\):|Thread"
      
      - name: VariÃ¡veis de ambiente do Linux
        run: |
          echo "ğŸ“‹ VariÃ¡veis de ambiente importantes:"
          echo "HOME: $HOME"
          echo "USER: $USER"
          echo "SHELL: $SHELL"
          echo "PATH: $PATH"

  # InstalaÃ§Ã£o de Pacotes
  package-management:
    runs-on: ubuntu-latest
    steps:
      - name: Atualizar lista de pacotes
        run: |
          echo "ğŸ”„ Atualizando lista de pacotes..."
          sudo apt-get update
      
      - name: Instalar pacotes do sistema
        run: |
          echo "ğŸ“¦ Instalando pacotes de exemplo..."
          sudo apt-get install -y curl wget jq
      
      - name: Verificar instalaÃ§Ã£o
        run: |
          echo "âœ… Verificando versÃµes instaladas:"
          curl --version | head -n 1
          wget --version | head -n 1
          jq --version

  # Docker no Runner Linux
  docker-examples:
    runs-on: ubuntu-latest
    steps:
      - name: Verificar Docker
        run: |
          echo "ğŸ³ Docker estÃ¡ prÃ©-instalado no runner:"
          docker --version
          docker compose version
      
      - name: Executar container Docker
        run: |
          echo "ğŸš¢ Executando container de exemplo..."
          docker run --rm hello-world
      
      - name: Usar Docker para executar comando
        run: |
          echo "ğŸ Executando Python em container:"
          docker run --rm python:3.11-slim python -c "print('Hello from Docker Python!')"
      
      - name: Listar imagens Docker
        run: |
          echo "ğŸ“‹ Imagens Docker disponÃ­veis:"
          docker images

  # Scripts Bash AvanÃ§ados
  bash-scripting:
    runs-on: ubuntu-latest
    steps:
      - name: Script bash com funÃ§Ãµes
        run: |
          #!/bin/bash
          
          # Definir funÃ§Ã£o
          function print_header() {
            echo "================================"
            echo "$1"
            echo "================================"
          }
          
          # Usar funÃ§Ã£o
          print_header "Script Bash AvanÃ§ado"
          
          # Loop
          echo "ğŸ”¢ Contando de 1 a 5:"
          for i in {1..5}; do
            echo "  NÃºmero: $i"
          done
          
          # Condicional
          if [ $(whoami) = "runner" ]; then
            echo "âœ… Executando como usuÃ¡rio 'runner'"
          fi
          
          # Arrays
          languages=("Python" "JavaScript" "Go" "Rust")
          echo "ğŸ’» Linguagens:"
          for lang in "${languages[@]}"; do
            echo "  - $lang"
          done
      
      - name: Processar arquivos
        run: |
          echo "ğŸ“ Criando arquivos de teste..."
          mkdir -p /tmp/test
          echo "Arquivo 1" > /tmp/test/file1.txt
          echo "Arquivo 2" > /tmp/test/file2.txt
          
          echo "ğŸ” Listando e processando arquivos:"
          find /tmp/test -name "*.txt" -exec echo "Encontrado: {}" \;
          
          echo "ğŸ§¹ Limpando..."
          rm -rf /tmp/test

  # Ferramentas PrÃ©-instaladas
  preinstalled-tools:
    runs-on: ubuntu-latest
    steps:
      - name: Ferramentas de desenvolvimento
        run: |
          echo "ğŸ› ï¸ === FERRAMENTAS PRÃ‰-INSTALADAS ==="
          echo ""
          echo "ğŸ“ Editores/Ferramentas:"
          git --version
          vim --version | head -n 1
          
          echo ""
          echo "ğŸ”§ Linguagens de ProgramaÃ§Ã£o:"
          python3 --version
          node --version
          npm --version
          go version
          java -version 2>&1 | head -n 1
          
          echo ""
          echo "ğŸ“¦ Gerenciadores de Pacotes:"
          pip3 --version
          gem --version
          
          echo ""
          echo "ğŸ”¨ Build Tools:"
          make --version | head -n 1
          cmake --version | head -n 1
          gcc --version | head -n 1

  # PermissÃµes e SeguranÃ§a
  permissions-security:
    runs-on: ubuntu-latest
    steps:
      - name: Verificar permissÃµes
        run: |
          echo "ğŸ”’ === PERMISSÃ•ES E SEGURANÃ‡A ==="
          echo ""
          echo "ğŸ‘¤ UsuÃ¡rio atual:"
          whoami
          id
          
          echo ""
          echo "ğŸ”‘ Pode usar sudo sem senha:"
          sudo -l | head -n 5
      
      - name: Criar arquivo com permissÃµes especÃ­ficas
        run: |
          echo "ğŸ“„ Criando arquivo com permissÃµes:"
          touch /tmp/test-file.txt
          chmod 644 /tmp/test-file.txt
          ls -l /tmp/test-file.txt
      
      - name: Executar com sudo
        run: |
          echo "âš¡ Executando comando com sudo:"
          sudo echo "Sudo funcionando sem senha!"

  # Networking
  networking:
    runs-on: ubuntu-latest
    steps:
      - name: Testar conectividade
        run: |
          echo "ğŸŒ === TESTES DE REDE ==="
          echo ""
          echo "ğŸ“¡ Interfaces de rede:"
          ip addr show
          
          echo ""
          echo "ğŸ” DNS:"
          cat /etc/resolv.conf
      
      - name: Fazer requisiÃ§Ãµes HTTP
        run: |
          echo "ğŸ“¨ Fazendo requisiÃ§Ã£o HTTP:"
          curl -s https://api.github.com/zen
          echo ""
          
          echo "ğŸ“Š Headers da resposta:"
          curl -I https://www.github.com 2>&1 | head -n 5
